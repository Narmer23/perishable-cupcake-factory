(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"3fe6":function(t,e,a){"use strict";a("e6cf");var r=a("9440");e["a"]={async getAll(){let{data:t}=await r["a"].get("/rest/cakes");return t},async getById(t){let{data:e}=await r["a"].get(`/rest/cakes/${t}`);return e},async create(t){let{data:e}=await r["a"].post("/rest/cakes",t);return e},async patch(t){let{data:e}=await r["a"].patch("/rest/cakes",t);return e},async delete(t){let{data:e}=await r["a"].delete(`/rest/cakes/${t}`);return e}}},7399:function(t,e,a){"use strict";a("e6cf");var r=a("9440");e["a"]={async getAvailable(t){let{data:e}=await r["a"].get("/rpc/batches/available",{params:{untilDate:t}});return e},async getAllWithExpire(t){let{data:e}=await r["a"].get("/rpc/batches/all",{params:{expireTarget:t}});return e},async getAll(){let{data:t}=await r["a"].get("/rest/batches");return t},async getById(t){let{data:e}=await r["a"].get(`/rest/batches/${t}`);return e},async create(t){let{data:e}=await r["a"].post("/rest/batches",t);return e},async patch(t){let{data:e}=await r["a"].patch("/rest/batches",t);return e},async delete(t){let{data:e}=await r["a"].delete(`/rest/batches/${t}`);return e}}},"8d7f":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{attrs:{padding:""}},[a("div",{staticClass:"row q-col-gutter-md"},[a("div",{staticClass:"col-12"},[a("div",{staticClass:"row items-center justify-between"},[a("div",{staticClass:"col text-h6 text-secondary"},[t._v("\n          Produzione\n        ")]),a("div",{staticClass:"col-auto"},[a("q-btn",{attrs:{label:"Nuova produzione",icon:"add",color:"primary"},on:{click:t.createNewBatch}})],1)])]),a("div",{staticClass:"col-12"},[a("q-table",{attrs:{data:t.orderedBatches,columns:t.columns,"row-key":"id",pagination:{rowsPerPage:15,page:1}},scopedSlots:t._u([{key:"body",fn:function(e){return[a("q-tr",{attrs:{props:e}},[a("q-td",{key:"quantity",attrs:{props:e}},[t._v("\n              "+t._s(e.row.quantity)+"\n            ")]),a("q-td",{key:"cake",attrs:{props:e}},[t._v("\n              "+t._s(e.row.cake.name)+"\n            ")]),a("q-td",{key:"productionDate",attrs:{props:e}},[t._v("\n              "+t._s(t._f("date")(e.row.productionDate,"LLL"))+"\n            ")]),a("q-td",{key:"elapsedTime",attrs:{props:e}},[t._v("\n              "+t._s(t._f("date")(e.row.productionDate,"calendar"))+"\n            ")]),a("q-td",{key:"price",attrs:{props:e}},[t._v("\n              "+t._s(e.row.batchPrice.toFixed(2))+" €\n            ")]),a("q-td",{key:"discount",attrs:{props:e}},[t._v("\n              "+t._s((100*(1-e.row.priceModifier)).toFixed(2))+" %\n            ")]),a("q-td",{key:"sellPrice",attrs:{props:e}},[t._v("\n              "+t._s((e.row.batchPrice*e.row.priceModifier).toFixed(2))+" €\n            ")]),a("q-td",{key:"expired",staticClass:"text-bold",attrs:{props:e}},[e.row.expired?a("div",{staticClass:"text-negative"},[t._v("\n                SCADUTO\n              ")]):e.row.priceModifier<1?a("div",{staticClass:"text-warning"},[t._v("\n                IN SCADENZA\n              ")]):t._e()]),a("q-td",{key:"actions",attrs:{props:e}},[a("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"delete",color:"negative"},on:{click:function(a){return t.deleteBatch(e.row.id)}}})],1)],1)]}}])})],1)])])},c=[],n=(a("e6cf"),a("7399")),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-dialog",{ref:"dialog",on:{hide:t.onDialogHide}},[a("q-card",{staticClass:"q-dialog-plugin"},[a("q-card-section",[a("div",{staticClass:"text-h6"},[t._v("\n        Nuova produzione\n      ")])]),a("q-card-section",[a("q-select",{attrs:{label:"Dolce",options:t.cakes,"option-label":"name","emit-value":"","map-options":"",error:t.$v.batch.cake.$error},on:{input:function(e){return t.$set(t.batch,"batchPrice",t.batch.cake.defaultPrice)}},model:{value:t.batch.cake,callback:function(e){t.$set(t.batch,"cake",e)},expression:"batch.cake"}}),a("q-input",{attrs:{type:"number",label:"Quantità",error:t.$v.batch.quantity.$error},model:{value:t.batch.quantity,callback:function(e){t.$set(t.batch,"quantity",e)},expression:"batch.quantity"}}),a("q-input",{attrs:{type:"number",label:"Prezzo di vendita",error:t.$v.batch.batchPrice.$error},model:{value:t.batch.batchPrice,callback:function(e){t.$set(t.batch,"batchPrice",e)},expression:"batch.batchPrice"}}),a("q-input",{attrs:{label:"Data di produzione"},scopedSlots:t._u([{key:"prepend",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{"now-btn":"",mask:t.dateFormat},model:{value:t.batch.productionDate,callback:function(e){t.$set(t.batch,"productionDate",e)},expression:"batch.productionDate"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0},{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"access_time"}},[a("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-time",{attrs:{"now-btn":"",mask:t.dateFormat,format24h:""},model:{value:t.batch.productionDate,callback:function(e){t.$set(t.batch,"productionDate",e)},expression:"batch.productionDate"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:t.batch.productionDate,callback:function(e){t.$set(t.batch,"productionDate",e)},expression:"batch.productionDate"}})],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",label:"Salva",disable:t.$v.batch.$invalid},on:{click:t.onOKClick}}),a("q-btn",{attrs:{color:"primary",label:"Cancel",flat:""},on:{click:t.onCancelClick}})],1)],1)],1)},s=[],o=a("b5ae"),l=a("3fe6"),d=a("bd4c");const p="YYYY-MM-DD HH:mm";var u={data(){return{dateFormat:p,batch:{productionDate:d["b"].formatDate(Date.now(),p)},cakes:[]}},validations:{batch:{quantity:{required:o["required"]},cake:{required:o["required"]},batchPrice:{required:o["required"]},productionDate:{required:o["required"]}}},async created(){this.cakes=await l["a"].getAll()},methods:{show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onDialogHide(){this.$emit("hide")},async onOKClick(){try{const t=d["b"].extractDate(this.batch.productionDate,p);this.batch.productionDate=+t;let e=await n["a"].create(this.batch);this.$emit("ok",e),this.hide()}catch(t){console.log(t)}},onCancelClick(){this.hide()}}},b=u,h=a("2877"),m=a("24e8"),y=a("f09f"),v=a("a370"),f=a("ddd8"),w=a("27f9"),q=a("0016"),k=a("7cbe"),g=a("52ee"),D=a("9c40"),x=a("ca78"),C=a("4b7e"),_=a("7f67"),$=a("eebe"),P=a.n($),Q=Object(h["a"])(b,i,s,!1,null,null,null),z=Q.exports;P()(Q,"components",{QDialog:m["a"],QCard:y["a"],QCardSection:v["a"],QSelect:f["a"],QInput:w["a"],QIcon:q["a"],QPopupProxy:k["a"],QDate:g["a"],QBtn:D["a"],QTime:x["a"],QCardActions:C["a"]}),P()(Q,"directives",{ClosePopup:_["a"]});var A=a("2ef0"),B=a.n(A),S={data(){return{columns:[{name:"quantity",align:"center",label:"Quantità disponibile",sortable:!0},{name:"cake",align:"left",label:"Dolce",sortable:!0},{name:"productionDate",align:"center",label:"Data di produzione",sortable:!0},{name:"elapsedTime",align:"left",label:"Sfornato",field:"quantity",sortable:!0},{name:"price",align:"center",label:"Prezzo",sortable:!0},{name:"discount",align:"center",label:"Sconto"},{name:"sellPrice",align:"center",label:"Prezzo di vendita",sortable:!0},{name:"expired",align:"center"},{name:"actions",align:"center"}],batches:[]}},computed:{orderedBatches(){return B.a.orderBy(this.batches,"productionDate",["desc"])}},async mounted(){this.batches=await n["a"].getAllWithExpire(+new Date)},methods:{createNewBatch(){this.$q.dialog({component:z,parent:this,cake:{}}).onOk((async()=>{this.batches=await n["a"].getAllWithExpire(+new Date)}))},async deleteBatch(t){await n["a"].delete(t);let e=this.batches.findIndex((e=>e.id==t));e>=0&&this.batches.splice(e,1)}}},N=S,T=a("9989"),E=a("eaac"),F=a("bd08"),I=a("db86"),O=Object(h["a"])(N,r,c,!1,null,null,null);e["default"]=O.exports;P()(O,"components",{QPage:T["a"],QBtn:D["a"],QTable:E["a"],QTr:F["a"],QTd:I["a"]})}}]);